pipeline { 
  agent any 
  environment { 
    BUILD_SCRIPTS_GIT="http://github.com/dangvinhnd99/kubernetes-full-stack-excample.git" 
    BUILD_SCRIPTS='mypipeline' 
    BUILD_HOME='/var/lib/jenkins/workspace' 
  } 
  stages { 
    stage('Checkout: Code') { 
          steps { 
            sh "mkdir -p $WORKSPACE/repo;\ 
                git config --global user.email dangvinhnd99.com;\ 
                git config --global user.name dangvinhnd99;\ 
                git config --global push.default simple;\ 
                git clone $BUILD_SCRIPTS_GIT repo/$BUILD_SCRIPTS" 
            sh "chmod -R +x $WORKSPACE/repo/$BUILD_SCRIPTS" 
          } 
    } 
    stage('Yum: Updates') { 
          steps { 
            sh "sudo chmod +x $WORKSPACE/repo/$BUILD_SCRIPTS/scripts/update.sh" 
            sh "sudo $WORKSPACE/repo/$BUILD_SCRIPTS/scripts/update.sh" 
          } 
    } 
  } 
  post { 
    always { 
       cleanWs() 
    } 
  }
}
